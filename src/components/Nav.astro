---
// Array con las rutas y nombres de los enlaces de la navegación principal del web.
const links = [
  { href: "/", label: "Inicio" },
  { href: "/carta", label: "Carta" },
  { href: "/contacto", label: "Nosotros" },
  { href: "/trabajo", label: "Únete al equipo" },
];
---
<nav class="primary-nav" aria-label="Navegación principal">
  <div class="site-header__inner">
    <a class="site-logo" href="/">
      <img src="/NuevoLogoWhite250px.png" alt="Kome Kome" />
    </a>

    <!-- Botón hamburguesa (visible en móvil) -->
    <button class="nav-toggle" aria-controls="site-nav" aria-expanded="false">
      <span class="nav-toggle__bar"></span>
      <span class="nav-toggle__bar"></span>
      <span class="nav-toggle__bar"></span>
      <span class="sr-only">Abrir menú</span>
    </button>

    <!-- Navegación -->
    <div id="site-nav" class="site-nav" data-open="false">
      <ul class="site-nav__list">
        <li><a href="/" aria-current="page">Inicio</a></li>
        <li><a href="/carta/">Carta</a></li>
        <li><a href="/contacto/">Contacto</a></li>
        <li><a href="/trabajo/">Trabajo</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- overlay para “pegar” el panel al header y cerrar al tocar fuera -->
<div class="nav-overlay" data-open="false" aria-hidden="true"></div>

<script is:inline>
  const btn = document.querySelector('.nav-toggle');
  const nav = document.getElementById('site-nav');
  const overlay = document.querySelector('.nav-overlay');
  const sr  = btn?.querySelector('.sr-only');

  function setButtonLabels(open) {
    const label = open ? 'Cerrar' : 'Abrir menú';
    btn?.setAttribute('aria-expanded', String(open));
    btn?.setAttribute('aria-label', label);
    btn?.setAttribute('title', label);
    if (sr) sr.textContent = label;
  }

  function toggleNav(force) {
    const open = (typeof force === 'boolean') ? force : (nav.dataset.open !== 'true');
    nav.dataset.open = String(open);
    overlay?.setAttribute('data-open', String(open));
    setButtonLabels(open);
    // bloquear scroll de fondo cuando abrimos
    document.documentElement.classList.toggle('no-scroll', open);
  }

  setButtonLabels(false);

  btn?.addEventListener('click', () => toggleNav());

  // Cerrar con tecla ESC
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') toggleNav(false);
  });

  // Cerrar al pulsar en overlay
  overlay?.addEventListener('click', () => toggleNav(false));

  // Cerrar al hacer click en cualquier enlace del menú
  nav?.addEventListener('click', (e) => {
    const a = e.target.closest('a');
    if (a) toggleNav(false);
  });
</script>
